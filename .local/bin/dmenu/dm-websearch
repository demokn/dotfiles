#!/usr/bin/env bash
#
# dm-websearch
# Description: Search various search engines (inspired by surfraw).

main() {
	# Choosing  a search engine by name from array above.
	# As this is loaded from other file it is technically not defined
	# shellcheck disable=SC2154 
	engine=$(printf '%s\n' "${!websearch[@]}" | sort | dmenu -i -l 20 -p 'Choose search engine:') "$@" || exit

  	# Getting the URL of the search engine we chose.
	url="${websearch["${engine}"]}"

  	# Searching the chosen engine.
	query=$(echo "$engine" | dmenu -p 'Enter search query:')

  	# Display search results in web browser
  	# shellcheck disable=SC2154
  	${websearch_browser} "${url}${query}"
}

websearch_browser="brave"
declare -A websearch
# Syntax:
# websearch[name]="https://www.example.com/search?q="

# Search Engines
websearch[bing]="https://www.bing.com/search?q="
websearch[duckduckgo]="https://duckduckgo.com/?q="
websearch[gemini search \(https\)]="https://portal.mozz.us/gemini/geminispace.info/search%3F"
websearch[google]="https://www.google.com/search?q="
websearch[qwant]="https://www.qwant.com/?q="
websearch[swisscows]="https://swisscows.com/web?query="
websearch[yandex]="https://yandex.com/search/?text="
# Information/News
websearch[bbcnews]="https://www.bbc.co.uk/search?q="
websearch[cnn]="https://www.cnn.com/search?q="
websearch[googlenews]="https://news.google.com/search?q="
websearch[wikipedia]="https://en.wikipedia.org/wiki/"
websearch[wiktionary]="https://en.wiktionary.org/wiki/"
# Social Media
websearch[reddit]="https://www.reddit.com/search/?q="
websearch[odysee]="https://odysee.com/$/search?q="
websearch[youtube]="https://www.youtube.com/results?search_query="
# Online Shopping
websearch[amazon]="https://www.amazon.com/s?k="
websearch[craigslist]="https://www.craigslist.org/search/sss?query="
websearch[ebay]="https://www.ebay.com/sch/i.html?&_nkw="
websearch[gumtree]="https://www.gumtree.com/search?search_category=all&q="
# Linux
websearch[archaur]="https://aur.archlinux.org/packages/?O=0&K="
websearch[archpkg]="https://archlinux.org/packages/?sort=&q="
websearch[archwiki]="https://wiki.archlinux.org/index.php?search="
websearch[debianpkg]="https://packages.debian.org/search?suite=default&section=all&arch=any&searchon=names&keywords="
# Development
websearch[github]="https://github.com/search?q="
websearch[gitlab]="https://gitlab.com/search?search="
websearch[googleOpenSource]="https://opensource.google/projects/search?q="
websearch[sourceforge]="https://sourceforge.net/directory/?q="
websearch[stackoverflow]="https://stackoverflow.com/search?q="
# Etc

[[ "${BASH_SOURCE[0]}" == "${0}" ]] && main "$@"
